20564

서로 다른 모든 흰색 정점 쌍의 LCA

시간제한 5초에 N, M이 50만.

---

일단 특정 노드가 바뀔 때마다 다른 모든 노드에 LCA를 해준다고 생각해보면

$O(M * N * logN)$ 절대 불가능 !

**특정 노드가 바뀌는 게 어떤 효과가 있는지 파악한다.**
   
segment tree의 다른 노드들에는 지금 선택된 현 노드와의 관계 말고도 다른 LCA 값들도 들어가있을거란 말이지.

그렇기 때문에 출력만 따지면 아마 $O(1)$이라 생각함. [1, N] 범위 출력해주면 되니까.

seg 리프 노드에는 다른 노드들과의 LCA가 들어가있고, seg 중간 노드들은 그들의 합. 이면 가장 이상적인 그림이긴 함.

일단 처음에 다 검은 노드만 있다고 생각해보자.

먼가 노드를 흰색으로 칠하면

모든 체인에 대해서 한번 돌아. $log N * log N$

1. 체인 안

2. 체인 밖
    이 체인 밖의 연결고리인 1번 노드 아래 체인애들은 1번 노드 level을 더해줘야함.


---

아이디어

체인들마다 id를 매겨.

그리고 체인의 상위 체인이 먼지도 안다면

아직 잘 모르겠네. 일단 넘어가자.